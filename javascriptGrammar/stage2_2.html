<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <style>
        /* ì„ íƒ ì‹œ ì‹œê°ì  ê°•ì¡° */
        .filter.active { font-weight: bold; }
        li.done        { text-decoration: line-through; color: gray; }
    </style>
</head>
<body>
<h2>í•  ì¼ ëª©ë¡</h2>

<!-- â‘  ì…ë ¥ í¼ -->
<input id="input-title" placeholder="í•  ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" />
<button id="btn-add">ì¶”ê°€</button>

<!-- (a) í•„í„° UI -->
<button data-view="all" class="filter active">ì „ì²´</button>
<button data-view="active" class="filter">ë¯¸ì™„ë£Œ</button>
<button data-view="completed" class="filter">ì™„ë£Œ</button>

<!-- â‘¡ ëª©ë¡ -->
<ul id="todo-list"></ul>

<p id="summary"></p>

<script>
    /***** ì „ì—­ ìƒíƒœ *****/
    let nextId = 1;
    let tasks = load();
    let viewMode = 'all';

    /***** í•„í„°ë³„ ê³„ì‚° *****/
    function getFiltered() {
        switch (viewMode) {
            case 'active':      return tasks.filter(t => !t.done);
            case 'completed':   return tasks.filter(t => t.done);
            default:            return tasks;
        }
    }

    /***** ë Œë” í•¨ìˆ˜ *****/
    function render() {
        const list = document.querySelector('#todo-list');
        list.innerHTML = '';

        /* (1) ê°œë³„ <li> ìƒì„± */
        getFiltered().forEach(t => {
            const li = document.createElement('li');
            li.textContent = t.title;
            li.dataset.id = t.id;
            if (t.done) li.classList.add('done');

            /* âœ… ì‚­ì œ ë²„íŠ¼ */
            const del = document.createElement('button');
            del.textContent = 'ğŸ—‘ï¸';
            del.className = 'btn-del';
            li.append(del);

            list.append(li);
        });

        /* (2) ìš”ì•½ */
        const remain = tasks.filter(t => !t.done).length;
        document.querySelector('#summary').textContent = remain === 0 ? 'ğŸ‰ ëª¨ë‘ ì™„ë£Œ!' : `ğŸ—’ï¸ ë‚¨ì€ ì¼: ${remain}ê°œ`;

        /* (3) í•„í„° ìƒíƒœ í‘œì‹œ */
        document.querySelectorAll('.filter').forEach(btn => btn.classList.toggle('active', btn.dataset.view === viewMode));
    }

    /***** ì…ë ¥ ì¶”ê°€ *****/
    document.querySelector('#btn-add').addEventListener('click', () => {
        const input = document.querySelector('#input-title');
        const title = input.value.trim();
        if (!title) return alert('ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”!');

        tasks.push({id: nextId++, title, done: false});
        input.value = '';
        save();
        render();
    });

    /***** (A) ì´ë²¤íŠ¸ ìœ„ì„: í† ê¸€ & ì‚­ì œ *****/
    document
        .querySelector('#todo-list')
        .addEventListener('click', e => {
            const li = e.target.closest('li');
            if (!li) return;

            const id = Number(li.dataset.id);
            const t = tasks.find(x => x.id === id);

            if (e.target.classList.contains('btn-del')) {
                // ğŸ—‘ï¸ ì‚­ì œ
                tasks = tasks.filter(x => x.id !== id);
            } else {
                // âœ… ì™„ë£Œ í† ê¸€
                t.done = !t.done;
            }
            save();
            render();
        });

    /***** (B) í•„í„° ë²„íŠ¼ í´ë¦­ *****/
    document
        .querySelectorAll('.filter')
        .forEach(btn => btn.addEventListener('click', () => {
            viewMode = btn.dataset.view;
            render();
        }));

    /***** (C) localStorage ì €ì¥/ë¡œë“œ *****/
    function save() {localStorage.setItem('tasks', JSON.stringify(tasks))}
    function load() {
        try {
            return JSON.parse(localStorage.getItem('tasks')) ?? [];
        } catch {return [];}
    }

    /***** ìµœì´ˆ ë Œë” *****/
    render();
</script>
</body>
</html>
